"use strict";!function(e,t,i,o){var c=window.wp.element.createElement,r=e.blocks.registerBlockType,s=e.components,a=(s.TextControl,s.SelectControl),l=s.ToggleControl,n=(s.RadioControl,s.RangeControl),p=s.SVG,_=s.Path,b=e.blockEditor.InspectorControls,g=e.apiFetch;r("getbowtied/sk-portfolio",{title:i.__("Portfolio","shopkeeper-portfolio"),icon:c(p,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},c(_,{d:"M14 6V4h-4v2h4zM4 8v11h16V8H4zm16-2c1.11 0 2 .89 2 2v11c0 1.11-.89 2-2 2H4c-1.11 0-2-.89-2-2l.01-11c0-1.11.88-2 1.99-2h4V4c0-1.11.89-2 2-2h4c1.11 0 2 .89 2 2v2h4z"})),category:"shopkeeper",supports:{align:["center","wide","full"]},styles:[{name:"default",label:i.__("Equal Boxes","shopkeeper-portfolio"),isDefault:!0},{name:"masonry_1",label:i.__("Masonry Style V1","shopkeeper-portfolio")},{name:"masonry_2",label:i.__("Masonry Style V2","shopkeeper-portfolio")},{name:"masonry_3",label:i.__("Masonry Style V3","shopkeeper-portfolio")}],attributes:{result:{type:"array",default:[]},queryItems:{type:"string",default:""},queryItemsLast:{type:"string",default:""},isLoading:{type:"bool",default:!1},categoriesIDs:{type:"string",default:","},categoriesSavedIDs:{type:"string",default:""},firstLoad:{type:"boolean",default:!0},number:{type:"number",default:"12"},columns:{type:"number",default:"3"},showFilters:{type:"boolean",default:!1},orderby:{type:"string",default:"date_desc"}},edit:function(_){function u(e,t,o){var r="/wp/v2/portfolio-item?per_page="+t;switch(","==e.substr(0,1)&&(e=e.substr(1)),","==e.substr(e.length-1)&&(e=e.substring(0,e.length-1)),","!=e&&""!=e&&(r="/wp/v2/portfolio-item?portfolio-category="+e+"&per_page="+t),o){case"date_asc":r+="&orderby=date&order=asc";break;case"date_desc":r+="&orderby=date&order=desc";break;case"title_asc":r+="&orderby=title&order=asc";break;case"title_desc":r+="&orderby=title&order=desc"}return r}function t(){var e=d.queryItems;_.setAttributes({queryItemsLast:e}),""!=e&&g({path:e}).then(function(e){_.setAttributes({result:e}),_.setAttributes({isLoading:!1}),_.setAttributes({doneFirstItemsLoad:!0})})}var o,r,s,d=_.attributes,e=_.className;return d.doneFirstLoad=d.doneFirstLoad||!1,d.categoryOptions=d.categoryOptions||[],d.doneFirstItemsLoad=d.doneFirstItemsLoad||!1,d.result=d.result||[],-1==e.indexOf("is-style-")&&(e+=" is-style-default"),[c(b,{key:"sk-portfolio-inspector"},c("div",{className:"main-inspector-wrapper"},c("label",{className:"components-base-control__label"},i.__("Categories:","shopkeeper-portfolio")),c("div",{className:"category-result-wrapper"},d.categoryOptions.length<1&&!1===d.doneFirstLoad&&(o=[],r=[],s=[],void g({path:"/wp/v2/portfolio-category?per_page=-1"}).then(function(e){for(var t=0;t<e.length;t++)o[t]={label:e[t].name.replace(/&amp;/g,"&"),value:e[t].id,parent:e[t].parent,count:e[t].count},r[t]=e[t].id.toString();s=function e(t,o){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=0;i<o.length;i++)o[i].parent==t&&(o[i].level=s,r.push(o[i]),e(o[i].value,o,r,s+1));return r}(0,o),_.setAttributes({categoryOptions:s}),function(e){var t=d.categoriesIDs,o=d.categoriesIDs;if(","==t.substr(0,1)&&(t=t.substr(1)),","==t.substr(t.length-1)&&(t=t.substring(0,t.length-1)),","!=t&&""!=t)for(var r=t.split(","),s=0;s<r.length;s++)-1==e.indexOf(r[s])&&(o=o.replace(","+r[s].toString()+",",","));d.categoriesIDs!=o&&(_.setAttributes({queryItems:u(o,d.number,d.orderby)}),_.setAttributes({queryItemsLast:u(o,d.number,d.orderby)})),_.setAttributes({categoriesIDs:o}),_.setAttributes({categoriesSavedIDs:o})}(r),_.setAttributes({doneFirstLoad:!0})})),function e(){var t,o,r,s,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,l=[],n=d.categoryOptions;if(0<n.length)for(var p=0;p<n.length;p++)n[p].parent==i&&l.push(c("li",{key:"portfolio_category_"+p,className:"level-"+n[p].level},c("label",{key:"portfolio_cat_label_"+p,className:(r=n[p].parent,s=n[p].value,(0==r?"parent parent-"+s:"child child-"+r)+" "+n[p].level)},c("input",{type:"checkbox",key:"category-checkbox-"+n[p].value,value:n[p].value,"data-index":p,"data-parent":n[p].parent,checked:(t=","+n[p].value+",",o=d.categoriesIDs,-1!=o.indexOf(t.toString())),onChange:function(e){var t=d.categoriesIDs,o=t.indexOf(","+e.target.value+",");!0===e.target.checked?-1==o&&(t+=e.target.value+","):-1<o&&(t=t.replace(","+e.target.value+",",",")),_.setAttributes({categoriesIDs:t}),_.setAttributes({queryItems:u(t,d.number,d.orderby)})}}),n[p].label,c("sup",{},n[p].count)),e(n[p].value,a+1)));return 0<l.length?c("ul",{className:"level-"+a},l):void 0}()),c(a,{key:"sk-latest-posts-order-by",options:[{value:"title_asc",label:i.__("Alphabetical Ascending","shopkeeper-portfolio")},{value:"title_desc",label:i.__("Alphabetical Descending","shopkeeper-portfolio")},{value:"date_asc",label:i.__("Date Ascending","shopkeeper-portfolio")},{value:"date_desc",label:i.__("Date Descending","shopkeeper-portfolio")}],label:i.__("Order By","shopkeeper-portfolio"),value:d.orderby,onChange:function(e){_.setAttributes({orderby:e});var t=d.categoriesIDs;_.setAttributes({queryItems:u(t,d.number,e)})}}),c(n,{key:"sk-portfolio-number",className:"range-wrapper",value:d.number,allowReset:!1,initialPosition:12,min:1,max:20,label:i.__("Number of Portfolio Items","shopkeeper-portfolio"),onChange:function(e){_.setAttributes({number:e});var t=d.categoriesIDs;_.setAttributes({queryItems:u(t,e,d.orderby)})}}),c("button",{className:"render-results components-button is-button is-default is-primary is-large "+(!0===d.isLoading?"is-busy":""),disabled:0==d.queryItems.length||d.queryItems===d.queryItemsLast,onClick:function(e){_.setAttributes({isLoading:!0}),_.setAttributes({categoriesSavedIDs:d.categoriesIDs}),t()}},!1===d.isLoading?i.__("Update","shopkeeper-portfolio"):i.__("Updating","shopkeeper-portfolio")),c("hr",{}),c(l,{key:"portfolio-filters-toggle",label:i.__("Show Filters?","shopkeeper-portfolio"),checked:d.showFilters,onChange:function(){_.setAttributes({showFilters:!d.showFilters})}}),-1!==_.className.indexOf("is-style-default")&&c(n,{key:"sk-portfolio-columns",value:d.columns,allowReset:!1,initialPosition:3,min:2,max:5,label:i.__("Columns","shopkeeper-portfolio"),onChange:function(e){_.setAttributes({columns:e})}}))),c("div",{key:"gbt_18_sk_editor_portfolio",className:"gbt_18_sk_editor_portfolio "+e},c("div",{key:"gbt_18_sk_editor_portfolio_wrapper",className:0<=e.indexOf("is-style-default")?"gbt_18_sk_editor_portfolio_wrapper items_per_row_"+d.columns:"gbt_18_sk_editor_portfolio_wrapper"},d.result.length<1&&!1===d.doneFirstItemsLoad&&t(),function(){!0===d.firstLoad&&g({path:"/wp/v2/portfolio-item?per_page=12&orderby=date&order=desc"}).then(function(e){_.setAttributes({result:e}),_.setAttributes({firstLoad:!1});var t="/wp/v2/portfolio-item?per_page=12&orderby=date&order=desc";_.setAttributes({queryItems:t}),_.setAttributes({queryItemsLast:t})});var e=d.result,t=[],o=[];if(0<e.length)for(var r=0;r<e.length;r++){var s=[];e[r].fimg_url&&s.push(c("span",{key:"gbt_18_sk_editor_portfolio_item_thumbnail",className:"gbt_18_sk_editor_portfolio_item_thumbnail",style:{backgroundImage:"url("+e[r].fimg_url+")"}})),t.push(c("div",{key:"gbt_18_sk_editor_portfolio_item_box_"+e[r].id,className:"gbt_18_sk_editor_portfolio_item_box"},c("a",{key:"gbt_18_sk_editor_portfolio_item_link_"+r,className:"gbt_18_sk_editor_portfolio_item_link",style:{backgroundColor:e[r].color_meta_box}},c("div",{key:"gbt_18_sk_editor_portfolio_item_content_"+r,className:"gbt_18_sk_editor_portfolio_item_content"},s,c("h2",{key:"gbt_18_sk_editor_portfolio_item_title_"+r,className:"gbt_18_sk_editor_portfolio_item_title",dangerouslySetInnerHTML:{__html:e[r].title.rendered}})))))}return o.push(c("div",{key:"gbt_18_sk_editor_portfolio_items",className:"gbt_18_sk_editor_portfolio_items"},t)),o}()))]},save:function(){return null}})}(window.wp,window.wp.blocks,window.wp.i18n);